# 权利要求书（标准格式）

## 发明名称
基于多尺度滑动窗口和专家网络的特征融合方法及系统

## 权利要求

### 权利要求1

一种基于多尺度滑动窗口和专家网络的特征融合方法，其特征在于，包括以下步骤：

**步骤S1：获取输入特征序列，所述输入特征序列包括多个图像块的特征向量，每个特征向量具有预设的特征维度；**

**步骤S2：利用多尺度滑动窗口处理单元对所述输入特征序列进行处理，使用至少三个不同尺度的滑动窗口分别对特征序列进行一维卷积操作，所述滑动窗口的尺度分别为4×4、8×8和16×16，每个尺度的滑动窗口使用对应的卷积核大小和步长；**

**步骤S3：对每个尺度的滑动窗口输出进行全局平均池化处理，得到各尺度的特征表示，当输入序列长度小于最小滑动窗口尺度时，直接对输入特征进行全局平均池化；**

**步骤S4：利用专家网络模块对多尺度特征进行专业化处理，为每个尺度配置专门的专家网络，每个专家网络包括多层感知机结构和残差连接机制，对对应尺度的特征进行特征增强和维度变换；**

**步骤S5：利用门控网络模块计算各专家网络的权重分布，将各尺度的特征进行拼接形成多尺度特征向量，通过门控网络的多层感知机结构计算权重，使用温度参数控制权重分布的尖锐程度，通过Softmax函数进行权重归一化；**

**步骤S6：根据门控网络计算的权重对各专家网络的输出进行加权求和，通过最终融合层对加权融合结果进行进一步处理，输出融合后的特征表示。**

### 权利要求2

根据权利要求1所述的方法，其特征在于，所述步骤S2中：

所述一维卷积操作的卷积核大小等于滑动窗口的尺度；

所述一维卷积操作的步长等于滑动窗口的尺度；

所述一维卷积操作不使用填充，确保输出长度正确。

### 权利要求3

根据权利要求1所述的方法，其特征在于，所述步骤S4中：

每个专家网络包括至少两层全连接层；

每个专家网络包括层归一化层和GELU激活函数；

每个专家网络包括Dropout正则化层；

每个专家网络通过残差连接将输入特征与处理后的特征相加。

### 权利要求4

根据权利要求1所述的方法，其特征在于，所述步骤S5中：

门控网络包括至少两层全连接层；

门控网络包括温度参数，用于控制权重分布的尖锐程度；

门控网络包括Dropout正则化层；

门控网络输出各专家的权重分布，权重和为1。

### 权利要求5

根据权利要求1所述的方法，其特征在于，所述步骤S6中：

最终融合层包括全连接层、层归一化层、GELU激活函数和Dropout层；

最终融合层的输出维度与输入特征维度相同；

最终融合层对加权融合结果进行特征增强处理。

### 权利要求6

一种基于多尺度滑动窗口和专家网络的特征融合系统，其特征在于，包括：

**多尺度特征提取模块，用于使用不同尺度的滑动窗口处理输入特征序列，包括滑动窗口处理单元和池化单元；**

**专家网络模块，包括多个专家网络，每个专家网络对应一个尺度，每个专家网络包括多层感知机结构和残差连接；**

**门控网络模块，包括门控网络和权重归一化单元，用于计算各专家网络的权重分布；**

**特征融合模块，包括加权融合单元和最终融合层，用于根据权重对各专家输出进行加权求和和进一步处理。**

### 权利要求7

根据权利要求6所述的系统，其特征在于，所述多尺度特征提取模块中：

滑动窗口处理单元包括三个一维卷积层，分别对应4×4、8×8和16×16尺度；

池化单元包括自适应平均池化层；

滑动窗口处理单元的输出通过池化单元得到各尺度的特征表示。

### 权利要求8

根据权利要求6所述的系统，其特征在于，所述专家网络模块中：

每个专家网络包括输入层、隐藏层和输出层；

每个专家网络包括残差连接，将输入特征与处理后的特征相加；

每个专家网络包括层归一化层和GELU激活函数；

每个专家网络包括Dropout正则化层。

### 权利要求9

根据权利要求6所述的系统，其特征在于，所述门控网络模块中：

门控网络包括至少两层全连接层；

门控网络包括温度参数控制单元；

权重归一化单元使用Softmax函数进行归一化；

门控网络输出各专家的权重分布。

### 权利要求10

根据权利要求6所述的系统，其特征在于，所述特征融合模块中：

加权融合单元根据门控网络计算的权重对各专家输出进行加权求和；

最终融合层包括全连接层、层归一化层、GELU激活函数和Dropout层；

最终融合层对加权融合结果进行特征增强处理。

### 权利要求11

一种跨模态行人重识别方法，其特征在于，包括：

**步骤S1：获取RGB、近红外和热红外三种模态的行人图像；**

**步骤S2：利用CLIP视觉编码器对每种模态的图像进行特征提取，得到各模态的图像块特征序列；**

**步骤S3：利用权利要求1所述的多尺度滑动窗口和专家网络特征融合方法对各模态的图像块特征序列进行处理，得到各模态的增强特征表示；**

**步骤S4：利用Mamba状态空间模型对多模态增强特征进行跨模态融合，通过SS2D_intra模块进行模态内特征处理，通过SS2D_inter模块进行模态间特征交互；**

**步骤S5：使用融合后的特征进行跨模态行人重识别，计算不同模态间的特征相似度，输出行人重识别结果。**

### 权利要求12

根据权利要求11所述的方法，其特征在于，所述步骤S4中：

使用MM_SS2D模块组合模态内和模态间处理；

SS2D_intra模块包括RGB、NIR、TIR三个模态的独立处理；

SS2D_inter模块包括多模态特征的交互处理；

Mamba状态空间模型支持双向处理机制。

### 权利要求13

一种计算机可读存储介质，其特征在于，存储有计算机程序，当所述计算机程序被处理器执行时，实现权利要求1所述的多尺度滑动窗口和专家网络特征融合方法。

### 权利要求14

一种电子设备，其特征在于，包括：

处理器；

存储器，存储有计算机程序；

当所述计算机程序被处理器执行时，实现权利要求1所述的多尺度滑动窗口和专家网络特征融合方法。

### 权利要求15

一种基于多尺度滑动窗口和专家网络的特征融合装置，其特征在于，包括：

**特征序列接收单元，用于接收输入图像的特征序列；**

**多尺度滑动窗口处理单元，用于使用不同尺度的滑动窗口处理特征序列；**

**专家网络处理单元，用于使用专家网络对多尺度特征进行专业化处理；**

**门控网络决策单元，用于计算各专家网络的权重分布；**

**加权融合单元，用于根据权重对各专家输出进行加权融合；**

**特征输出单元，用于输出融合后的特征表示。**

## 技术效果

本发明通过多尺度滑动窗口特征提取和专家网络融合机制，实现了以下技术效果：

1. **多尺度感知能力**：通过4×4、8×8、16×16三个尺度的滑动窗口，能够捕获从局部细节到全局上下文的多层次空间信息。

2. **专业化处理优势**：每个专家网络专门处理特定尺度的特征，避免了不同尺度特征间的相互干扰，提高了特征表示质量。

3. **自适应融合能力**：通过门控网络动态计算各专家的权重，能够根据输入内容自适应地选择重要的特征信息。

4. **计算效率优势**：相比传统的注意力机制，具有更低的计算复杂度，计算开销仅增加约8%。

5. **性能提升效果**：在跨模态行人重识别任务中，相比基线方法在mAP和Rank-1指标上分别提升了2.6%和2.2%。

## 应用领域

本发明可应用于以下领域：

1. **跨模态行人重识别**：RGB、近红外、热红外图像间的行人匹配
2. **多尺度目标检测**：需要处理不同尺度目标的检测任务
3. **特征融合**：需要融合多尺度特征的各种计算机视觉任务
4. **专家系统**：需要专业化处理不同输入类型的智能系统

## 技术优势

1. **创新性**：首次将多尺度滑动窗口与专家网络机制结合，实现了多尺度特征的专业化处理
2. **有效性**：在多个评估指标上均取得显著提升
3. **实用性**：计算开销小，易于实现和部署
4. **通用性**：方法设计通用，可应用于其他基于深度学习的视觉任务
5. **可解释性**：专家权重分布提供了模型决策的可解释性
