
conda activate MambaPro
python train_net.py --config_file configs/RGBNT201/MambaPro.yml

<!-- 除了数据集RGBNT100需要把参数IMS_PER_BATCH: 128改为64之外，其他配置文件参数不需要做修改。 -->
<!-- 实验数据集：RGBNT201 - MSVR310 - RGBNT100 -->

<!-- 1. RBGNT201 -->
python train_net.py --config_file configs/RGBNT201/MambaPro.yml

<!-- 2.  RGBNT100-->
<!-- 学习率：0.000175 -->
python train_net.py --config_file configs/RGBNT100/MambaPro.yml


2025-9-23 更新
# 1. 基线实验
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --disable_moe

# 2. 仅多尺度滑动窗口实验  
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --disable_moe --use_multi_scale

# 3. 多尺度滑动窗口 + MoE实验
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --use_moe

# 4. 优化MoE实验（调整参数后）
python train_net.py --config_file configs/RGBNT201/MambaPro_moe_optimized.yml

# ========== MoE有效性验证实验 ==========
# 实验目的：验证MoE模块的有效性，证明MoE融合比传统方法更有效
# 实验设计：对比基线方法与MoE方法的性能差异

# 5. 基线实验（多尺度滑动窗口，无MoE）
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --disable_moe --use_multi_scale

# 6. MoE实验（多尺度滑动窗口 + 优化MoE融合）
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml

# ========== 实验记录系统 ==========
# 实验目的：自动记录实验配置、结果和分析
# 功能：便于实验管理和结果对比

# 7. 带记录的基础实验
python quick_experiment_log.py configs/RGBNT201/MambaPro.yml "baseline_experiment"

# 8. 带记录的多尺度实验
python quick_experiment_log.py configs/RGBNT201/MambaPro.yml "multi_scale_experiment"

# 9. 带记录的MoE实验
python quick_experiment_log.py configs/RGBNT201/MambaPro_moe.yml "moe_experiment"

# 10. 查看实验总结
python quick_experiment_log.py

# ========== 参数覆盖记录系统 ==========
# 实验目的：记录实验时实际使用的参数，包括命令行覆盖的参数
# 功能：确保参数记录准确，便于实验复现和对比

# 11. 基础实验（记录所有参数）
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "baseline_experiment"

# 12. 多尺度实验（启用多尺度，记录参数）
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "multi_scale_experiment" --use_multi_scale

# 13. MoE实验（启用MoE，记录参数）
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "moe_experiment" --use_moe

# 14. 自定义参数实验（记录覆盖的参数）
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "custom_experiment" --use_moe --base_lr 0.0003 --max_epochs 80 --moe_expert_hidden_dim 512 --moe_temperature 0.5

# 15. 参数调优实验（记录不同参数组合）
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "lr_tuning_experiment" --use_moe --base_lr 0.0002
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "expert_dim_tuning" --use_moe --moe_expert_hidden_dim 2048
python parameter_override_logger.py configs/RGBNT201/MambaPro.yml "temperature_tuning" --use_moe --moe_temperature 0.3


2025-9-26 更新
# ========== 消融实验：单尺度滑动窗口测试 ==========
# 实验目的：验证不同尺度滑动窗口的独立效果
# 实验设计：分别测试4×4、8×8、16×16三个尺度的独立效果

# 4. 仅4×4小尺度滑动窗口实验
python train_net.py --config_file configs/RGBNT201/ablation_scale4_only.yml

# 5. 仅8×8中尺度滑动窗口实验
python train_net.py --config_file configs/RGBNT201/ablation_scale8_only.yml

# 6. 仅16×16大尺度滑动窗口实验
python train_net.py --config_file configs/RGBNT201/ablation_scale16_only.yml

# ========== 消融实验说明 ==========
# 实验配置：
# - 滑动窗口：启用单尺度滑动窗口
# - MoE融合：禁用
# - 特征类型：根据尺度不同捕获不同层次特征
# 
# 预期效果：
# - 4×4小尺度：捕获局部细节和纹理信息
# - 8×8中尺度：捕获结构信息和对象部件
# - 16×16大尺度：捕获全局上下文和场景信息
# 
# 输出目录：
# - 4×4实验：outputs/ablation_scale4_only/
# - 8×8实验：outputs/ablation_scale8_only/
# - 16×16实验：outputs/ablation_scale16_only/
# 
# 分析维度：
# - 性能对比：各尺度对mAP和Rank-1的贡献
# - 特征分析：不同尺度捕获的特征类型
# - 效率分析：计算开销和训练时间对比

2025-1-15 更新
# ========== 当前可用MoE实验命令 ==========
# 实验目的：使用当前修复后的配置进行MoE实验
# 实验设计：验证多尺度滑动窗口+MoE融合的完整效果

# 1. 基线实验（无多尺度，无MoE）
python train_net.py --config_file configs/RGBNT201/MambaPro.yml

# 2. 多尺度滑动窗口实验（无MoE）
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --use_multi_scale

# 3. MoE多尺度特征融合实验（完整功能）
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml

# 4. 优化MoE实验（使用最优参数）
python train_net.py --config_file configs/RGBNT201/MambaPro_moe_optimal.yml

# ========== 实验配置说明 ==========
# 实验配置：
# - 数据集：RGBNT201
# - 骨干网络：ViT-B-16 (CLIP)
# - 多尺度滑动窗口：4×4、8×8、16×16
# - MoE融合：专家网络动态融合
# - 优化器：Adam (学习率0.0005)
# - 训练轮数：60 epochs
# - 批次大小：32

# 预期效果：
# - 基线实验：建立性能基准
# - 多尺度实验：验证滑动窗口效果
# - MoE实验：验证专家网络融合效果
# - 优化MoE：使用调优参数获得最佳性能

# 输出目录：
# - 基线实验：outputs/baseline_experiment/
# - 多尺度实验：outputs/multi_scale_experiment/
# - MoE实验：outputs/moe_innovation_experiment/
# - 优化MoE：outputs/moe_optimized_experiment/

# 性能预期：
# - 多尺度滑动窗口：mAP +2-3%, Rank-1 +2-3%
# - MoE融合：mAP +3-5%, Rank-1 +3-5%
# - 优化MoE：mAP +4-6%, Rank-1 +4-6%

# ========== 快速测试命令 ==========
# 实验目的：快速验证MoE模块是否正常工作
# 实验设计：使用小批次和短训练时间进行功能测试

# 5. 快速MoE功能测试（5个epochs）
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --max_epochs 5 --ims_per_batch 16

# 6. 快速多尺度测试（5个epochs）
python train_net.py --config_file configs/RGBNT201/MambaPro.yml --use_multi_scale --max_epochs 5 --ims_per_batch 16

# ========== 实验监控命令 ==========
# 实验目的：实时监控训练过程和MoE模块状态
# 实验设计：使用监控脚本跟踪训练状态

# 7. 带监控的MoE实验
python monitor_training.py --config_file configs/RGBNT201/MambaPro_moe.yml --monitor_moe

# 8. 带监控的多尺度实验
python monitor_training.py --config_file configs/RGBNT201/MambaPro.yml --use_multi_scale --monitor_multi_scale

# ========== 参数调优命令 ==========
# 实验目的：测试不同MoE参数组合的效果
# 实验设计：系统性地测试关键参数

# 9. MoE温度参数调优
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_temperature 0.5
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_temperature 0.7
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_temperature 1.0

# 10. MoE专家隐藏层维度调优
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_expert_hidden_dim 512
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_expert_hidden_dim 1024
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_expert_hidden_dim 2048

# 11. MoE损失权重调优
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_balance_loss_weight 0.005
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_balance_loss_weight 0.01
python train_net.py --config_file configs/RGBNT201/MambaPro_moe.yml --moe_balance_loss_weight 0.02

# ========== 实验分析命令 ==========
# 实验目的：分析实验结果和MoE模块行为
# 实验设计：使用分析脚本深入理解MoE效果

# 12. 实验结果分析
python analyze_results.py --experiment_dir outputs/moe_innovation_experiment

# 13. MoE专家权重分析
python analyze_results.py --experiment_dir outputs/moe_innovation_experiment --analyze_moe_weights

# 14. 多尺度特征分析
python analyze_results.py --experiment_dir outputs/moe_innovation_experiment --analyze_multi_scale_features

# ========== 实验记录命令 ==========
# 实验目的：自动记录实验配置和结果
# 实验设计：便于实验管理和结果对比

# 15. 记录MoE实验
python quick_experiment_log.py configs/RGBNT201/MambaPro_moe.yml "moe_innovation_experiment"

# 16. 记录优化MoE实验
python quick_experiment_log.py configs/RGBNT201/MambaPro_moe_optimal.yml "moe_optimized_experiment"

# 17. 查看实验总结
python quick_experiment_log.py

# ========== 实验使用说明 ==========
# 实验流程：
# 1. 先运行基线实验建立基准
# 2. 运行多尺度实验验证滑动窗口效果
# 3. 运行MoE实验验证专家网络融合效果
# 4. 运行优化MoE实验获得最佳性能
# 5. 使用分析脚本深入理解实验结果

# 注意事项：
# - 确保GPU内存充足（建议8GB以上）
# - 实验前检查配置文件路径是否正确
# - 使用监控脚本跟踪训练状态
# - 定期保存检查点以防训练中断

# 预期输出：
# - 训练日志：包含MoE模块启动信息和专家权重分布
# - 性能指标：mAP、Rank-1、Rank-5等关键指标
# - 专家分析：各专家使用频率和权重分布
# - 特征分析：多尺度特征的互补性和有效性