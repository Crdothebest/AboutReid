# 多尺度滑动窗口配置说明

## 🎯 **配置方案总览**

我们提供了4种不同的配置方案，让您可以根据需要选择合适的backbone和多尺度设置：

### **方案对比表**

| 配置文件名 | Backbone | 多尺度滑动窗口 | 用途 | 输出目录 |
|-----------|----------|----------------|------|----------|
| `MambaPro_ViT_Baseline.yml` | ViT-B-16 | ❌ 关闭 | 基线对比 | `ViT_Baseline/` |
| `MambaPro_ViT_MultiScale.yml` | ViT-B-16 | ✅ 启用 | ViT+多尺度 | `ViT_MultiScale/` |
| `MambaPro_T2T_Baseline.yml` | T2T-ViT-24 | ❌ 关闭 | T2T基线 | `T2T_Baseline/` |
| `MambaPro_T2T_MultiScale.yml` | T2T-ViT-24 | ✅ 启用 | T2T+多尺度 | `T2T_MultiScale/` |

## 🔧 **配置详解**

### **1. ViT-B-16 + 多尺度滑动窗口**
```yaml
# 文件：MambaPro_ViT_MultiScale.yml
MODEL:
  TRANSFORMER_TYPE: 'vit_base_patch16_224'  # ViT-B-16 backbone
  USE_MULTI_SCALE: True                     # 启用多尺度
  MULTI_SCALE_SCALES: [4, 8, 16]           # 滑动窗口尺度
```

**特点**：
- ✅ 使用成熟的ViT-B-16架构
- ✅ 有丰富的预训练权重
- ✅ 多尺度滑动窗口增强特征表示
- ✅ 适合与现有方法对比

### **2. T2T-ViT-24 + 多尺度滑动窗口**
```yaml
# 文件：MambaPro_T2T_MultiScale.yml
MODEL:
  TRANSFORMER_TYPE: 't2t_vit_t_24'         # T2T-ViT-24 backbone
  USE_MULTI_SCALE: True                     # 启用多尺度
  MULTI_SCALE_SCALES: [4, 8, 16]           # 滑动窗口尺度
```

**特点**：
- ✅ 使用T2T的渐进式token重组
- ✅ 与多尺度滑动窗口理念高度匹配
- ✅ 更大的模型容量（24层）
- ✅ 创新的架构组合

### **3. 基线配置**
```yaml
# 文件：MambaPro_ViT_Baseline.yml 或 MambaPro_T2T_Baseline.yml
MODEL:
  USE_MULTI_SCALE: False  # 关闭多尺度
```

**特点**：
- ✅ 用于性能对比
- ✅ 验证多尺度模块的有效性
- ✅ 提供公平的基线

## 🚀 **使用方法**

### **训练命令**
```bash
# 训练ViT-B-16 + 多尺度
python train_net.py --config_file configs/MSVR310/MambaPro_ViT_MultiScale.yml

# 训练T2T-ViT-24 + 多尺度
python train_net.py --config_file configs/MSVR310/MambaPro_T2T_MultiScale.yml

# 训练基线模型
python train_net.py --config_file configs/MSVR310/MambaPro_ViT_Baseline.yml
```

### **测试命令**
```bash
# 测试ViT-B-16 + 多尺度
python test_net.py --config_file configs/MSVR310/MambaPro_ViT_MultiScale.yml

# 测试T2T-ViT-24 + 多尺度
python test_net.py --config_file configs/MSVR310/MambaPro_T2T_MultiScale.yml
```

## 📊 **实验建议**

### **实验流程**
1. **基线实验**：先训练基线模型，建立性能基准
2. **多尺度实验**：训练多尺度版本，验证性能提升
3. **对比分析**：比较不同配置的性能差异

### **预期结果**
- **ViT-B-16 + 多尺度** vs **ViT-B-16基线**：验证多尺度模块的有效性
- **T2T-ViT-24 + 多尺度** vs **T2T-ViT-24基线**：验证T2T架构的优势
- **T2T-ViT-24 + 多尺度** vs **ViT-B-16 + 多尺度**：比较不同backbone的性能

## ⚙️ **配置参数说明**

### **多尺度相关参数**
```yaml
USE_MULTI_SCALE: True/False        # 是否启用多尺度滑动窗口
MULTI_SCALE_SCALES: [4, 8, 16]     # 滑动窗口尺度列表
```

### **Backbone相关参数**
```yaml
TRANSFORMER_TYPE: 'vit_base_patch16_224'  # ViT-B-16
TRANSFORMER_TYPE: 't2t_vit_t_24'          # T2T-ViT-24
```

### **输出目录**
```yaml
OUTPUT_DIR: '/path/to/outputs/ModelName/'  # 模型输出目录
```

## 🔍 **验证方法**

### **快速验证**
```bash
# 运行集成测试
python test_multi_scale_integration.py

# 测试特定配置
python -c "
import yaml
with open('configs/MSVR310/MambaPro_ViT_MultiScale.yml', 'r') as f:
    config = yaml.safe_load(f)
    print('配置加载成功:', config['MODEL']['TRANSFORMER_TYPE'])
    print('多尺度启用:', config['MODEL']['USE_MULTI_SCALE'])
"
```

## 📝 **注意事项**

1. **预训练权重**：确保预训练权重路径正确
2. **输出目录**：不同配置使用不同的输出目录，避免冲突
3. **GPU内存**：T2T-ViT-24模型更大，需要更多GPU内存
4. **训练时间**：多尺度模块会增加训练时间

## 🎯 **推荐使用顺序**

1. **开始**：使用 `MambaPro_ViT_Baseline.yml` 建立基线
2. **验证**：使用 `MambaPro_ViT_MultiScale.yml` 验证多尺度效果
3. **探索**：使用 `MambaPro_T2T_MultiScale.yml` 探索T2T架构
4. **对比**：使用 `MambaPro_T2T_Baseline.yml` 进行公平对比

这样您就可以全面评估多尺度滑动窗口模块在不同backbone上的效果！
